group_by(species_id) %>%
summarise(n=n())
surveys %>% ggplot(aes(factor(species_id))) +
geom_bar() +
scale_y_continuous(trans = 'log10')
high_counts <- species_counts %>%
filter(n > 10) %>%
select(species_id)
surveys_subset <- surveys %>%
filter(species_id %in% high_counts$species_id)
surveys_subset %>% ggplot(aes(factor(species_id), weight)) +
geom_boxplot()
# add jitter to see how many points are per boxplot
surveys_subset %>% ggplot(aes(factor(species_id), weight)) +
geom_boxplot() +
geom_jitter(alpha=0.1)
# different way to look at it is violoin plot
surveys_subset %>% ggplot(aes(factor(species_id), weight)) +
geom_violin()
# challange would be do the same for length
# counts in time per species
# remove unannotated species
surveys_subset %<>% filter(species_id != "")
# summarise counts per year per species
yearly_counts <- surveys_subset %>%
group_by(year, species_id) %>%
summarise(count=n())
yearly_counts %>% ggplot(aes(x=year,
y=count,
group=species_id,
color=species_id)) +
geom_line()
yearly_counts %>% ggplot(aes(x=year,
y=count,
color=species_id)) +
geom_line()
yearly_counts %>% ggplot(aes(x=year,
y=count,
color=species_id)) +
geom_line() +
facet_wrap(~species_id)
require(devtools)
install_github('rCharts', 'ramnathv')
install_github('ramnathv/rCharts')
library(tidyr)
library(plyr)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(magrittr)
library(gridExtra)
library(rmarkdown)
library(hexbin)
library(ggsubplot)
rwc <- read.csv(data/rwc.csv)
rwc <- read.csv("data/rwc.csv")
rwc <- read.csv("data/rwc.csv")
View(rwc)
ggplot(rwc, x = temp, y = RWC, color = water) +
geom_point(position = jitter) +
geom_boxplot() +
facet_grid(~transfer)
ggplot(rwc, x = temp, y = RWC, color = water) +
geom_point(position = jitter) +
facet_grid(~transfer)
ggplot(rwc, aes(x = temp, y = RWC, color = water)) +
geom_point(position = jitter) +
geom_boxplot() +
facet_grid(~transfer)
ggplot(rwc, aes(x = temp, y = RWC, color = water)) +
geom_point(position = jitter)
ggplot(rwc, aes(x = temp, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~transfer)
ggplot(rwc, aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc %>%
filter(transfer == "13d" | transfer == "9d") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc %>%
filter(transfer == "13d" | transfer == "9d" | temp == "high") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc %>%
filter(transfer == "13d" | transfer == "9d" | temp == "high") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot()
rwc <- read.csv("data/rwc.csv")
rwc %>%
filter(transfer == "13d" | transfer == "9d") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
filter(transfer == "13d" | transfer == "9d") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot()
filter(transfer == "13d" | transfer == "9d") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc %>%
filter(transfer == "13d" | transfer == "9d") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot()
rwc %>%
filter(transfer == "13d" | transfer == "9d") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc %>%
filter(transfer == "13d" | transfer == "9d" | temp == "high") %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot()
rwc <- read.csv("data/rwc.csv")
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc <- read.csv("data/rwc.csv")
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp) +
ggsave("rwc.pdf", height = 10, width = 10, units = "cm", useDingbats = FALSE)
library(tidyr)
library(plyr)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(magrittr)
library(gridExtra)
library(rmarkdown)
library(hexbin)
library(ggsubplot)
moist_cal <- read.csv("data/moisture_calib.csv")
View(moist_cal)
moist_cal %>%
ggplot(aes(x = pixel_int, y = moist)) +
geom_point()
moist_cal %>%
ggplot(aes(x = pixel_int, y = moisture)) +
geom_point()
moist_cal %>%
ggplot(aes(x = pixel_int, y = moisture)) +
geom_point() +
stat_smooth()
moist_cal %>%
ggplot(aes(x = pixel_int, y = moisture)) +
geom_point() +
stat_smooth(method=lm)
moist_cal %>%
ggplot(aes(x = pixel_int, y = moisture)) +
geom_point(size = 3) +
stat_smooth(method=lm) +
theme_bw()
moist_cal <- read.csv("data/moisture_calib.csv")
moist_cal %>%
ggplot(aes(x = pixel_int, y = moisture)) +
geom_point(size = 3) +
stat_smooth(method=lm) +
xlab("Pixel intensity") +
ylab("Pixel intensity") +
theme_bw() +
ggsave("moisture_calibration.pdf", height = 8, width = 8, units = "cm", useDingbats = FALSE)
moist_cal %>%
ggplot(aes(x = pixel_int, y = moisture)) +
geom_point(size = 3) +
stat_smooth(method=lm) +
xlab("Pixel intensity") +
ylab("Water content (%)") +
theme_bw() +
ggsave("moisture_calibration.pdf", height = 8, width = 8, units = "cm", useDingbats = FALSE)
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc <- read.csv("data/rwc.csv")
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
facet_grid(~temp)
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
xlab("Transfer Day") +
ylab("Relative water content (%)") +
theme_bw()
facet_grid(~temp) +
ggsave("rwc.pdf", height = 10, width = 10, units = "cm", useDingbats = FALSE)
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
xlab("Transfer Day") +
ylab("Relative water content (%)") +
theme_bw()
facet_grid(~temp) +
ggsave("rwc.pdf", height = 10, width = 10, units = "cm", useDingbats = FALSE)
rwc <- read.csv("data/rwc.csv")
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
xlab("Transfer Day") +
ylab("Relative water content (%)") +
theme_bw()
facet_grid(~temp)
rwc <- read.csv("data/rwc.csv")
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
xlab("Transfer Day") +
ylab("Relative water content (%)") +
facet_grid(~temp) +
theme_bw()
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
xlab("Transfer Day") +
ylab("Relative water content (%)") +
facet_grid(~temp) +
theme_bw()
ggsave("rwc.pdf", height = 8, width = 8, units = "cm", useDingbats = FALSE)
rwc %>%
ggplot(aes(x = transfer, y = RWC, color = water)) +
geom_boxplot() +
xlab("Transfer Day") +
ylab("Relative water content (%)") +
facet_grid(~temp) +
theme_bw()
ggsave("rwc.pdf", height = 10, width = 10, units = "cm", useDingbats = FALSE)
install.packages("qtl")
install.packages(c("qtl", "htmlwidgets", "devtools"))
library(devtools)
install_github("kbroman/qtlcharts")
save.image()
library(qtl)
ls()
help(read.cross)
?read.cross
data(hyper)
ls()
?hyper
summary(hyper)
nind(hyper)
nphe(hyper)
nchr(hyper)
totmar(hyper)
nmar(hyper)
plot(hyper)
plotMissing(hyper)
plotMap(hyper)
plotPheno(hyper, pheno.col=1)
plotMap(hyper, chr=c(1, 4, 6, 7, 15), show.marker.names=TRUE)
plotMissing(hyper, reorder=TRUE)
hyper <- drop.nullmarkers(hyper)
totmar(hyper)
hyper <- est.rf(hyper)
plotRF(hyper)
plotRF(hyper, chr=6)
plotRF(hyper, chr=c(1,4))
plotRF(hyper, chr=6)
plotMissing(hyper, chr=6)
newmap <- est.map(hyper, error.prob=0.01)
plotMap(hyper, newmap)
library(tidyr)
library(plyr)
library(dplyr)
library(RColorBrewer)
library(ggplot2)
library(magrittr)
library(gridExtra)
library(rmarkdown)
library(hexbin)
library(ggsubplot)
seg <- read.csv("data/2015-02-23-soil-data-all.csv")
seg$humidity <- 221.0 - (3.96 * seg$environment)
seg$das <- substr(seg$image, start = 4, stop = 5)
seg$treatment <- substr(seg$image, start = 11, stop = 12)
# Create a depth factor
max <- max(seg$start_y)
seg$depth[seg$start_y < (max/3)] <- 1
seg$depth[seg$start_y > (max/3) & seg$start_y < (2*(max/3))] <- 2
seg$depth[seg$start_y > (2*(max/3))] <- 3
View(seg)
ggplot(data = seg, aes(x = humidity, y = direction)) +
facet_grid(depth~das) +
geom_point(aes(colour=treatment), size=1, alpha=0.7) +
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]")
fit <- lm(seg$direction ~ seg$humidity)
summary(fit)
ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_abline(intercept = fit$coefficients[[1]], slope = fit$coefficients[[2]], colour="grey")+
geom_point(aes(colour=treatment), size=1, alpha=0.7) +
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]")
rs <- ddply(seg, .( treatment, das), summarise,
dir = mean(direction),
dir.sd = sd(direction),
envi=mean(humidity, na.rm = T),
envi.sd=sd(humidity, na.rm = T))
fit <- lm(rs$dir ~ rs$envi)
print(summary(fit))
ggplot(data = rs,aes(x = envi, y = dir)) +
geom_abline(intercept = fit$coefficients[[1]], slope = fit$coefficients[[2]], colour="grey")+
geom_point(aes(colour=treatment), size=2, alpha=0.7) +
geom_errorbar(aes(ymin = dir-dir.sd, ymax = dir+dir.sd, height=0, colour=treatment), alpha=0.7) +
geom_errorbarh(aes(xmin = envi-envi.sd, xmax = envi+envi.sd, height=0, colour=treatment), alpha=0.7) +
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]")
seg <- read.csv("data/2015-02-23-soil-data-diff.csv")
seg$humidity <- 221.0 - (3.96 * seg$environment)
seg$das <- substr(seg$image, start = 4, stop = 5)
seg$treatment <- substr(seg$image, start = 11, stop = 12)
# Create a depth factor
max <- max(seg$start_y)
seg$depth[seg$start_y < (max/3)] <- 1
seg$depth[seg$start_y > (max/3) & seg$start_y < (2*(max/3))] <- 2
seg$depth[seg$start_y > (2*(max/3))] <- 3
seg %>%
filter(das >15) %>%
ggplot(aes(x = humidity, y = direction)) +
facet_grid(~das) +
geom_point(aes(colour=treatment), size=3, alpha=0.7) +
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]")
fit <- lm(seg$direction ~ seg$humidity)
print(summary(fit))
ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_abline(intercept = fit$coefficients[[1]], slope = fit$coefficients[[2]], colour="grey")+
geom_point(aes(colour=treatment), size=1, alpha=0.7) +
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]")
fit <- lm(seg$direction ~ seg$humidity)
print(summary(fit))
ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_point(aes(colour=treatment), size=1, alpha=0.7) +
facet_grid(depth~das) +
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]")
rs <- ddply(seg, .( treatment, das), summarise,
dir = mean(direction),
dir.sd = sd(direction),
envi=mean(humidity, na.rm = T),
envi.sd=sd(humidity, na.rm = T)),
dir.se = se(direction),
envi.se=se(humidity, na.rm = T))
fit <- lm(rs$dir ~ rs$envi)
print(summary(fit))
ggplot(data = rs,aes(x = envi, y = dir)) +
geom_point(aes(colour=treatment), size=2, alpha=0.7) +
geom_errorbar(aes(ymin = dir-dir.sd, ymax = dir+dir.sd, height=0, colour=treatment), size=0.5, alpha=0.7) +
geom_errorbarh(aes(xmin = envi-envi.sd, xmax = envi+envi.sd, height=0, colour=treatment), size=0.5, alpha=0.7) +
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]") +
ggsave("angle_moisture.pdf", height = 8, width = 10, units =
"cm",useDingbats = FALSE)
ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_point(aes(colour=treatment), size=3, alpha=0.7) +
xlim(30, 80)+
theme_bw()+
ylab("Root direction [째]") +
xlab("Moisture content [%]") +
ggsave("angle_moisture_no_average.pdf", height = 8, width = 10, units =
"cm",useDingbats = FALSE)
ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_point(aes(colour=treatment), size=3, alpha=0.7) +
xlim(30, 80)+
theme_bw()+
geom_rug(col=rgb(.5,0,0,alpha=.2))+
ylab("Root direction [째]") +
xlab("Moisture content [%]") +
ggsave("angle_moisture_rug.pdf", height = 8, width = 10, units =
"cm",useDingbats = FALSE)
ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_point(aes(colour=treatment), size=3, alpha=0.7) +
xlim(30, 80)+
theme_bw()+
geom_rug(col=rgb(.5,0,0,alpha=.2))+
facet_grid(~treatment)+hi
ylab("Root direction [째]") +
xlab("Moisture content [%]") +
ggsave("angle_moisture_rug_facet.pdf", height = 8, width = 10, units =
"cm",useDingbats = FALSE)
ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_point(aes(colour=treatment), size=3, alpha=0.7) +
xlim(30, 80)+
theme_bw()+
geom_density2d(aes(color=treatment))+
ylab("Root direction [째]") +
xlab("Moisture content [%]") +
ggsave("angle_moisture_density2d.pdf", height = 8, width = 10, units =
"cm",useDingbats = FALSE)
scatter <- ggplot(data = seg, aes(x = humidity, y = direction)) +
geom_point(aes(colour=treatment), size=3, alpha=0.7) +
xlim(30, 85)+
theme(legend.position=c(1,1),legend.justification=c(1,1)) +
ylab("Root direction [째]") +
xlab("Moisture content [%]")
histogram_x <- ggplot(data = seg, aes(humidity)) +
geom_density(aes(colour = treatment, fill = treatment, alpha = 0.7)) +
xlim(30, 80) +
theme(legend.position = "none")
histogram_y <- ggplot(data = seg, aes(direction)) +
geom_density(aes(colour = treatment, fill = treatment, alpha = 0.7)) +
coord_flip() +
theme(legend.position = "none")
empty <- ggplot()+geom_point(aes(1,1), colour="white") +
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
) +
grid.arrange(histogram_x, empty, scatter, histogram_y, ncol=2, nrow=2, widths=c(4, 1), heights=c(1, 4)) +
ggsave("angle_moisture_histogram_scatter.pdf", height = 10, width = 10, units =
"cm",useDingbats = FALSE)
scatter <- ggplot(data = seg, aes(x = direction, y = humidity)) +
geom_point(aes(colour=treatment), size=2, alpha=0.7) +
ylim(35, 80)+
geom_density2d(aes(color=treatment))+
ylab("Moisture content [%]") +
xlab("Root direction [째]") +
theme_bw() +
theme(legend.position=c(1,1),legend.justification=c(1,1))
histogram_x <- ggplot(data = seg, aes(direction)) +
geom_density(aes(colour = treatment, fill = treatment, alpha = 0.7)) +
xlab("Root Direction [쨘]") +
theme_bw() +
theme(legend.position = "none")
histogram_y <- ggplot(data = seg, aes(humidity)) +
geom_density(aes(colour = treatment, fill = treatment, alpha = 0.7)) +
xlab("Moisture content [%]") +
xlim(35, 80) +
coord_flip() +
theme_bw() +
theme(legend.position = "none")
empty <- ggplot()+geom_point(aes(1,1), colour="white") +
theme(
plot.background = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank()
)
grid.arrange(histogram_x, empty, scatter, histogram_y, ncol=2, nrow=2, widths=c(3.5, 1), heights=c(1, 3.5)) +
ggsave("angle_moisture_histogram_scatter_density.pdf", height = 10, width = 10, units =
"cm",useDingbats = FALSE)
install.packages(c("qtl", "htmlwidgets", "devtools"))
library(devtools)
install_github("kbroman/qtlcharts")
library(qtl)
library(qtlcharts)
data(hyper)
hyper <- calc.genoprob(hyper, step=1)
out <- scanone(hyper)
iplotScanone(out, hyper)
data(geneExpr)
iplotCorr(geneExpr$expr, geneExpr$genotype)
n.ind <- 500
n.gene <- 10000
expr <- matrix(rnorm(n.ind * n.gene, (1:n.ind)/n.ind*3), ncol=n.gene)
dimnames(expr) <- list(paste0("ind", 1:n.ind),
paste0("gene", 1:n.gene))
# generate the plot
iboxplot(expr)
library(qtl)
ls()
library(qtl)
ls()
ls()
library("qtlcharts", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
read.cross()
?read.cross()
data(hyper)
ls()
summary(hyper)
nind(hyper)
plot(hyper)
plotMap(hyper, chr=c(1), show.marker.names=TRUE)
plotPheno(hyper, pheno.col=1)
hyper <- est.rf(hyper)plotRF(hyper)plotRF(hyper, chr=c(1,4))
plotGeno(hyper, chr=16, ind=c(24:34, 71:81))
hyper <- calc.genoprob(hyper, step=1, error.prob=0.01)
plot(out.2p
plot(out.2p)
plot(out.2p)
