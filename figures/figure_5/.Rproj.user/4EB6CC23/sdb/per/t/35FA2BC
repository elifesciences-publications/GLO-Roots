{
    "contents" : "---\ntitle: \"figure_5\"\nauthor: \"Guillaume Lobet & and Ruben Rellan\"\ndate: \"February 4, 2015\"\noutput: pdf_document\n---\n\n```{r}\nlibrary(tidyr)\nlibrary(dplyr)\nlibrary(RColorBrewer)\nlibrary(ggplot2)\nlibrary(magrittr)\nlibrary(png)\nlibrary(grid)\nlibrary(plotly)\n\n```\n\n\n\nPlotting reporter data from the ZAT12:LUC2 salt addition experiment\n\n\n```{r}\n# Load the reporter data\nreporter <- read.csv(\"data/reporter.csv\")\n\n# Load the segment data\nsegments <- read.csv(\"data/seg.csv\")\n# Use for each time point the complete structure (from time point 1)\nseg <- segments[segments$time_in_serie == 1,]\nsegments <- seg\nfor(i in 2:max(reporter$time_in_serie)){\n  seg$time_in_serie <- i\n  segments <- rbind(segments, seg)\n}\n\n#calculate growth data\n\nreporter$growth = 0\nreporter$growth.x = 0\nreporter$growth.y = 0\nfor(n in reps){\ntemp <- reporter[reporter$rep_id == n,]\nreporter$growth.x[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_x)))\nreporter$growth.y[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_y)))\n}\nreporter$growth <- sqrt(reporter$growth.x^2 + reporter$growth.y^2)\nreps <- unique(reporter$rep_id)\nreporter$growth = 0\nreporter$growth.x = 0\nreporter$growth.y = 0\nfor(n in reps){\ntemp <- reporter[reporter$rep_id == n,]\nreporter$growth.x[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_x)))\nreporter$growth.y[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_y)))\n}\nreporter$growth <- sqrt(reporter$growth.x^2 + reporter$growth.y^2)\nreporter <- reporter[reporter$growth < 30,]\n\n\nreporter1 <- reporter[,c(2,4:9)]\nreporter1$diameter <- round(reporter1$diameter, 2)\nreporter1$intensity <- round(reporter1$intensity, 2)\nreporter1$intensity_ratio <- round(reporter1$intensity_ratio, 2)\nreporter1$growth <- round(reporter1$growth , 2)\nwrite.csv(reporter1, \"~/Dropbox/research/scripts/websites/gloroot_d3/reporters.csv\", row.names=F)\n\n\n\n# transform pixels into cm:\n\nreporter <- reporter %>%\n  mutate(depth = rep_y/138.6, width=rep_x/138,6)\n\nsegments <- segments %>%\n  mutate(start_depth = start_y/138.6, start_width=start_x/138.6, end_depth = end_y/138.6, end_width=end_x/138.6)\n\n\nggplot(reporter, aes(x = rep_x, y = desc(rep_y), size = intensity)) +\n\n# Add the segment data\n\ngeom_segment(data=segments,aes(data=segments,aes(x = start_width, y = -start_depth, xend = end_width, yend = -end_depth), size=0.5, colour=\"grey\", show_guide=F) + facet_grid(~ time_in_serie) +\n\n# Add the reporter data\n\n  geom_point(colour = \"magenta\", alpha=0.7) +\n  coord_fixed(ratio = 1) +\n  theme_bw() +\n  ggsave(\"zat12_intensity.pdf\", height = 12, width = 8, units = \"cm\", \n         useDingbats = FALSE)\n\n```\n\n\nNow we will plot the growth data wit some intensity as an aesthetic depending on zat12 intensity\n\n```{r}\n\n\np <- ggplot(reporter, aes(x = width, y = desc(depth), colour = intensity)) +\n\n# Add the segment data\n\ngeom_segment(data=segments,aes(x = start_width, y = -start_depth, xend = end_width, yend = -end_depth), size=0.5, colour=\"grey\", show_guide=F) +\nfacet_grid(~ time_in_serie) +\n\n# Add the reporter data\n\ngeom_point() +\nscale_colour_gradientn(colours=rainbow(6))+\ncoord_fixed(ratio = 1) +\ntheme_bw() +\n  ggsave(\"growth_intensity.pdf\", height = 20, width = 22, units = \"cm\", \n         useDingbats = FALSE)\n\n\n```\n\nr <- py$ggplotly(p)\n\nCorrelation between growth and zat12 expression?\n\n```{r}\nreporter %>%\n  filter(growth != 0)  %>%\nggplot(aes(x = growth, y = intensity, alpha= time_in_serie)) +\n  geom_point(size = 3) +\n  theme_bw() +\n  ggsave(\"growth_intensity_correlation.pdf\", height = 8, width = 8, units = \"cm\", \n         useDingbats = FALSE)\n\n```\n\n\nRoot-root interactions data\n\n```{r}\nroot_root <- read.csv(\"data/root-root.csv\")\n\np1 <-root_root %>%\n        filter(genotype == \"Col-LUC2\" | genotype == \"Sha-LUC2\") %>%\n        ggplot(aes(x = factor(plants), y = rsa_area, color = factor(plants))) +\n        geom_boxplot() +\n        geom_point(aes(size =3)) +\n        facet_grid(~genotype) +\n        labs(x = \"Number of plants in rhizotron\", y = \"Root system area (cm2)\") +\n        theme(panel.grid.major = element_blank(), \n              panel.grid.minor = element_blank()) +\n        theme_bw() \nggsave(\"r_r_root_area.pdf\", height = 8, width = 12, units = \"cm\", \n         useDingbats = FALSE)\n\np2 <-root_root %>%\n        filter(genotype == \"Col-LUC2\" | genotype == \"Sha-LUC2\") %>%\n        ggplot(aes(x = factor(plants), y = shoot_area, color = factor(plants))) +\n        geom_boxplot() +\n        geom_point(aes(size =3)) +\n        facet_grid(~genotype) +\n        labs(x = \"Number of plants in rhizotron\", y = \"Shoot area (cm2)\") +\n        theme(panel.grid.major = element_blank(), \n              panel.grid.minor = element_blank()) +\n        theme_bw()\nggsave(\"r_r_shoot_area.pdf\", height = 8, width = 12, units = \"cm\", \n         useDingbats = FALSE)\n\ngrid.arrange(p1, p2, ncol=1)\n\nggsave(\"r_r_combined_area.pdf\", height = 10, width = 12, units = \"cm\", \n         useDingbats = FALSE)\n        \n```\n\n\nSR9 Experiment\n\nPlotting reporter data from the ZAT12:LUC2 salt addition experiment\n\n\n```{r}\n# Load the reporter data\nreporter <- read.csv(\"data/sr10-reporter.csv\")\n\n# Load the segment data\nsegments <- read.csv(\"data/sr10-seg.csv\")\n# Use for each time point the complete structure (from time point 1)\nseg <- segments[segments$time_in_serie == 1,]\nsegments <- seg\nfor(i in 2:max(reporter$time_in_serie)){\n  seg$time_in_serie <- i\n  segments <- rbind(segments, seg)\n}\n\n#calculate growth data\n\nreporter$growth = 0\nreporter$growth.x = 0\nreporter$growth.y = 0\nfor(n in reps){\ntemp <- reporter[reporter$rep_id == n,]\nreporter$growth.x[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_x)))\nreporter$growth.y[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_y)))\n}\nreporter$growth <- sqrt(reporter$growth.x^2 + reporter$growth.y^2)\nreps <- unique(reporter$rep_id)\nreporter$growth = 0\nreporter$growth.x = 0\nreporter$growth.y = 0\nfor(n in reps){\ntemp <- reporter[reporter$rep_id == n,]\nreporter$growth.x[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_x)))\nreporter$growth.y[reporter$rep_id == n] <- c(0, abs(diff(temp$rep_y)))\n}\nreporter$growth <- sqrt(reporter$growth.x^2 + reporter$growth.y^2)\nreporter <- reporter[reporter$growth < 30,]\n\n\nreporter1 <- reporter[,c(2,4:9)]\nreporter1$diameter <- round(reporter1$diameter, 2)\nreporter1$intensity <- round(reporter1$intensity, 2)\nreporter1$intensity_ratio <- round(reporter1$intensity_ratio, 2)\nreporter1$growth <- round(reporter1$growth , 2)\nwrite.csv(reporter1, \"reporters.csv\", row.names=F)\n\n\n\n# transform pixels into cm:\n\nreporter <- reporter %>%\n  mutate(depth = rep_y/138.6, width=rep_x/138,6)\n\nsegments <- segments %>%\n  mutate(start_depth = start_y/138.6, start_width=start_x/138.6, end_depth = end_y/138.6, end_width=end_x/138.6)\n\n\nggplot(reporter, aes(x = rep_x, y = desc(rep_y), size = intensity)) + \n  geom_segment(data =segments, aes(x = start_width, y = -start_depth, xend = end_width, yend = -end_depth), size=0.5, colour=\"grey\", show_guide=F) +                                                                                      facet_grid(~ time_in_serie) +\n  geom_point(colour = \"magenta\", alpha=0.7) +\n  coord_fixed(ratio = 1) +\n  theme_bw() +\n  ggsave(\"zat12_intensity.pdf\", height = 12, width = 8, units = \"cm\", \n         useDingbats = FALSE)\n\n```\n\n\nNow we will plot the growth data wit some intensity as an aesthetic depending on zat12 intensity\n\n```{r}\n\n\np <- ggplot(reporter, aes(x = width, y = desc(depth), colour = intensity)) +\n\n# Add the segment data\n\ngeom_segment(data=segments,aes(x = start_width, y = -start_depth, xend = end_width, yend = -end_depth), size=0.5, colour=\"grey\", show_guide=F) +\nfacet_grid(~ time_in_serie) +\n\n# Add the reporter data\n\ngeom_point() +\nscale_colour_gradientn(colours=rainbow(6))+\ncoord_fixed(ratio = 1) +\ntheme_bw() +\n  ggsave(\"growth_intensity.pdf\", height = 20, width = 22, units = \"cm\", \n         useDingbats = FALSE)\n\n\n```\n\ncomparison of root intensity profiles along lateral roots\n\n\n```{r}\n\nroot_intensity <- read.csv(\"data/reporter_intensity.csv\")\n\nroot_intensity %>%\n  ggplot(aes(x = Distance_From_Tip, y = Intensity, colour = Reporter)) +\n  geom_point(size = 3, alpha = 0.6) +\n  facet_wrap(~ Reporter, scales=\"free\") +\n  theme_bw() +\n  ggsave(\"reporter_intensity.pdf\", height = 10, width = 18, units = \"cm\", \n         useDingbats = FALSE)\n\n```\n\n",
    "created" : 1431121364602.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1260884611",
    "id" : "35FA2BC",
    "lastKnownWriteTime" : 1433179360,
    "path" : "~/Dropbox/repos/glo_roots/figures/figure_5/figure_5.Rmd",
    "project_path" : "figure_5.Rmd",
    "properties" : {
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "type" : "r_markdown"
}